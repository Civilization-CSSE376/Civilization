import java.awt.BorderLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.ButtonGroup;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JRadioButton;

@SuppressWarnings("serial")
public class GameSetup extends JFrame {

	private static final int WINDOW_WIDTH = 1800;
	private static final int WINDOW_HEIGHT = 1000;

	private String language;
	private String player1Civilization;
	private String player2Civilization;

	private JPanel languageManager = new JPanel();
	private JPanel player1CivilizationManager = new JPanel();
	private JPanel player2CivilizationManager = new JPanel();

	public GameSetup() {
		this.setLayout(null);
		this.setTitle("Civilization Setup");
		ImageIcon icon = new ImageIcon("src/civilizationicon.jpg");
		this.setIconImage(icon.getImage());

		this.setLayout(new GridLayout(7, 1));

		JLabel languageSelection = new JLabel("Choose a language.",
				JLabel.CENTER);
		JLabel player1CivilizationSelection = new JLabel(
				"Player 1, Choose your civilization.", JLabel.CENTER);
		JLabel player2CivilizationSelection = new JLabel(
				"Player 2, Choose your civilization.", JLabel.CENTER);

		JButton done = new JButton("Play!");

		// Language Selection
		JRadioButton chooseEnglish = new JRadioButton("English");
		chooseEnglish.addActionListener(new LanguageRadioListener());
		chooseEnglish.setSelected(true);
		this.language = chooseEnglish.getText();

		JRadioButton chooseSpanish = new JRadioButton("Spanish");
		chooseSpanish.addActionListener(new LanguageRadioListener());

		ButtonGroup languageChoices = new ButtonGroup();
		languageChoices.add(chooseEnglish);
		languageChoices.add(chooseSpanish);
		
		String[] civs = { "Russia", "Germany", "Egypt", "Rome", "America", "China"};
		ButtonGroup player1CivilizationChoices = new ButtonGroup();

		// Player 1 Civilization Selection
		for(int i = 0; i < 6; i++){
			JRadioButton chooseCiv = new JRadioButton(civs[i]);
			chooseCiv.addActionListener(new Player1CivRadioListener());
			if(i == 0) {
				chooseCiv.setSelected(true);
				this.player1Civilization = chooseCiv.getText();
			}
			player1CivilizationChoices.add(chooseCiv);
		}

		player1CivilizationChoices.add(chooseRussia);
		player1CivilizationChoices.add(chooseGermany);
		player1CivilizationChoices.add(chooseEgypt);
		player1CivilizationChoices.add(chooseRome);
		player1CivilizationChoices.add(chooseAmerica);
		player1CivilizationChoices.add(chooseChina);

		// Player 2 Civilization Selection
		JRadioButton chooseRussia2 = new JRadioButton("Russia");
		chooseRussia2.addActionListener(new Player2CivRadioListener());
		chooseRussia2.setSelected(true);
		this.player2Civilization = chooseRussia2.getText();

		JRadioButton chooseGermany2 = new JRadioButton("Germany");
		chooseGermany2.addActionListener(new Player2CivRadioListener());

		JRadioButton chooseEgypt2 = new JRadioButton("Egypt");
		chooseEgypt2.addActionListener(new Player2CivRadioListener());

		JRadioButton chooseRome2 = new JRadioButton("Rome");
		chooseRome2.addActionListener(new Player2CivRadioListener());

		JRadioButton chooseAmerica2 = new JRadioButton("America");
		chooseAmerica2.addActionListener(new Player2CivRadioListener());

		JRadioButton chooseChina2 = new JRadioButton("China");
		chooseChina2.addActionListener(new Player2CivRadioListener());

		ButtonGroup player2CivilizationChoices = new ButtonGroup();
		player2CivilizationChoices.add(chooseRussia2);
		player2CivilizationChoices.add(chooseGermany2);
		player2CivilizationChoices.add(chooseEgypt2);
		player2CivilizationChoices.add(chooseRome2);
		player2CivilizationChoices.add(chooseAmerica2);
		player2CivilizationChoices.add(chooseChina2);

		this.languageManager.add(chooseEnglish);
		this.languageManager.add(chooseSpanish);

		this.player1CivilizationManager.add(chooseRussia);
		this.player1CivilizationManager.add(chooseGermany);
		this.player1CivilizationManager.add(chooseEgypt);
		this.player1CivilizationManager.add(chooseRome);
		this.player1CivilizationManager.add(chooseAmerica);
		this.player1CivilizationManager.add(chooseChina);

		this.player2CivilizationManager.add(chooseRussia2);
		this.player2CivilizationManager.add(chooseGermany2);
		this.player2CivilizationManager.add(chooseEgypt2);
		this.player2CivilizationManager.add(chooseRome2);
		this.player2CivilizationManager.add(chooseAmerica2);
		this.player2CivilizationManager.add(chooseChina2);

		this.add(languageSelection);
		this.add(this.languageManager);
		this.add(player1CivilizationSelection);
		this.add(this.player1CivilizationManager);
		this.add(player2CivilizationSelection);
		this.add(this.player2CivilizationManager);
		this.add(done);
		this.setVisible(true);

		this.setDefaultCloseOperation(EXIT_ON_CLOSE);

		done.addActionListener(new ActionListener() {

			@Override
			public void actionPerformed(ActionEvent e) {
				if (GameSetup.this.player1Civilization
						.equals(GameSetup.this.player2Civilization)) {
					makeWarningWindow();
				} else {
					GameSetup.this.setVisible(false);
					GameSetup.this.dispose();
					CreateMainWindow(GameSetup.this.language,
							GameSetup.this.player1Civilization,
							GameSetup.this.player2Civilization);
				}
			}

		});
	}

	private void makeWarningWindow() {
		final JFrame warningWindow = new JFrame();
		JPanel text = new JPanel();
		JLabel warning = new JLabel("Player 1 and player 2 cannot choose the same civilization.");
		text.add(warning);
		
		JButton button = new JButton("Ok");
		
		button.addActionListener(new ActionListener(){

			@Override
			public void actionPerformed(ActionEvent e) {
				warningWindow.setVisible(false);
				warningWindow.dispose();
				
			}
			
		});
		
		warningWindow.add(text);
		warningWindow.add(button, BorderLayout.SOUTH);
		warningWindow.pack();
		warningWindow.setVisible(true);
	}

	private void CreateMainWindow(String language, String p1Civilization,
			String p2Civilization) {
		JFrame mainWindow = new MainWindow(language, p1Civilization,
				p2Civilization);

		mainWindow.setSize(WINDOW_WIDTH, WINDOW_HEIGHT);
		mainWindow.setResizable(false);

		mainWindow.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		mainWindow.setVisible(true);
	}

	public class LanguageRadioListener implements ActionListener {

		@Override
		public void actionPerformed(ActionEvent e) {
			GameSetup.this.language = e.getActionCommand();
		}

	}

	public class Player1CivRadioListener implements ActionListener {

		@Override
		public void actionPerformed(ActionEvent e) {
			GameSetup.this.player1Civilization = e.getActionCommand();
		}

	}

	public class Player2CivRadioListener implements ActionListener {

		@Override
		public void actionPerformed(ActionEvent e) {
			GameSetup.this.player2Civilization = e.getActionCommand();

		}

	}
}